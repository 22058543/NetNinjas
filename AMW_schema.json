{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AMW Schema",
  "description": "Schema for AMW data structure",
  "type": "object",
  "properties": {
    "application": {
      "type": "object",
      "description": "Root",
      "properties": {
        "name": {
          "type": "string",
          "const": "AMW",
          "description": "Application name"
        },
        "version": {
          "type": "string",
          "description": "Application version"
        },
        "environment": {
          "type": "string",
          "description": "Deployment environment",
          "enum": ["development", "staging", "production"]
        },
        "currentView": {
          "type": "string",
          "description": "Current view in the application",
          "enum": ["dashboard", "story_editor", "media_upload", "settings", "chapters"]
        }
      },
      "required": ["name", "version", "environment", "currentView"]
    },
    "user": {
      "type": "object",
      "description": "User profile",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique user identifier from Cognito"
        },
        "cognitoId": {
          "type": "string",
          "description": "Cognito user ID"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100,
          "description": "User's full name"
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "User's email address"
        },
        "avatar": {
          "type": ["string", "null"],
          "format": "uri",
          "description": "URL to user's avatar image"
        },
        "role": {
          "type": "string",
          "description": "User role in the application",
          "enum": ["admin", "user", "moderator"],
          "default": "user"
        },
        "preferences": {
          "type": "object",
          "description": "User preferences",
          "properties": {
            "theme": {
              "type": "string",
              "enum": ["default", "light", "dark"],
              "default": "default"
            },
            "notifications": {
              "type": "boolean",
              "default": true
            },
            "autosave": {
              "type": "boolean",
              "default": true
            }
          }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "lastLogin": {
          "type": ["string", "null"],
          "format": "date-time"
        }
      },
      "required": ["id", "cognitoId", "name", "email", "role"]
    },
    "stories": {
      "type": "array",
      "description": "List of stories",
      "items": {
        "type": "object",
        "properties": {
          "id": {
             "type": "string" 
            },
          "title": { 
            "type": "string", 
            "minLength": 1, 
            "maxLength": 200 
        },
          "description": { 
            "type": ["string", "null"], 
            "maxLength": 1000 
        },
          "status": { 
            "type": "string", 
            "enum": ["draft", "published", "archived", "private"], 
            "default": "draft" 
        },
          "visibility": { 
            "type": "string", 
            "enum": ["public", "private", "shared"], 
            "default": "private" 
        },
          "thumbnail": {
             "type": ["string", "null"], 
             "format": "uri" 
            },
          "chapterCount": { 
            "type": "integer", 
            "minimum": 0 
        },
          "momentCount": { 
            "type": "integer", 
            "minimum": 0 
        },
          "authorId": { 
            "type": "string" 
        },
          "createdAt": { 
            "type": "string", 
            "format": "date-time" 
        },
          "updatedAt": { 
            "type": ["string", "null"], 
            "format": "date-time" 
        },
          "publishedAt": { 
            "type": ["string", "null"], 
            "format": "date-time" 
        },
          "tags": { 
            "type": "array", 
            "items": { 
                "type": "string"
                }
            } 
        },
        "required": ["id", "title", "authorId", "createdAt", "status"]
      }
    },
    "chapters": {
      "type": "array",
      "description": "List of chapters within a story",
      "items": {
        "type": "object",
        "properties": {
          "id": { 
            "type": "string" 
        },
          "storyId": { 
            "type": "string" 
        },
          "title": { 
            "type": "string", 
            "minLength": 1, 
            "maxLength": 200 
        },
          "description": { 
            "type": ["string", "null"], 
            "maxLength": 1000 
        },
          "status": { 
            "type": "string", 
            "enum": ["draft", "published", "archived"], "default": "draft" 
        },
          "order": { 
            "type": "integer", 
            "minimum": 1 
        },
          "createdAt": { 
            "type": "string", 
            "format": "date-time" 
        },
          "updatedAt": { 
            "type": ["string", "null"], 
            "format": "date-time" 
        }
        },
        "required": ["id", "storyId", "title", "order", "createdAt"]
      }
    },
    "moments": {
      "type": "array",
      "description": "List of moments in a chapter",
      "items": {
        "type": "object",
        "properties": {
          "id": { 
            "type": "string" 
        },
          "chapterId": { 
            "type": "string" 
        },
          "storyId": { 
            "type": "string"
        },
          "type": { 
            "type": "string", 
            "enum": ["text", "image", "video", "audio"] 
        },
          "title": { "type": ["string", "null"], 
          "maxLength": 200 
        },
          "description": { 
            "type": ["string", "null"], 
            "maxLength": 1000 
        },
          "content": { 
            "type": "string", 
            "maxLength": 1000 
        },
          "createdAt": { 
            "type": "string", 
            "format": "date-time" 
        },
          "updatedAt": { 
            "type": ["string", "null"], 
            "format": "date-time" 
        },
        "media": {
          "type": ["object", "null"],
            "properties": {
              "url": { 
                "type": "string", 
                "format": "uri" 
                },
                "thumbnail": { 
                    "type": ["string", "null"], 
                    "format": "uri"
                },
                "fileName": {
                    "type": "string"
                },
                "fileSize": {
                    "type": "integer",
                    "minimum": 0
                },
                "duration": {
                    "type": ["integer", "null"],
                    "minimum": 0
                }
                }
               },
                "required": ["url"]
        },
        "attribution": {
            "type": ["string", "null"],
            "maxLength": 300
        }
        },
        "required": ["id", "chapterId", "content", "createdAt"]
    }
  },
  "required": ["application", "user", "stories", "chapters", "moments"]
}
